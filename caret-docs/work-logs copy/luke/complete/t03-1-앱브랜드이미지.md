# Luke Yang - t03-1 앱 브랜딩 통합 시스템 개선

**작업 기간**: 2025-08-31 ~ 진행중  
**담당자**: Luke Yang  
**우선순위**: High  
**AI 어시스턴트**: Claude Code  
**최종 업데이트**: 2025-08-31 15:30

## 🎯 현재 문제점 분석

### 1. 분산된 브랜딩 시스템
```
현재 구조 (복잡함):
caret-b2b/tools/
├── cline-brand-change.js         # cline ↔ caret 전용
├── codecenter-brand.js           # caret ↔ codecenter 전용  
├── universal-brand.js            # 범용 시도
├── image-resource-conversion.js  # 이미지 전환 전용
├── image-path-toggle.js          # 이미지 경로 전환 전용
└── b2b-brands-change.js          # 중복 기능

설정 파일 분산:
├── assets/brand-config.json    # cline ↔ caret 설정
└── brands/codecenter/brand.json      # codecenter 설정 (다른 형식)
```

### 2. 터미널 아이콘/이름 문제
**파일**: `caret-main/src/integrations/terminal/TerminalRegistry.ts:24-34`
```javascript
// 하드코딩된 문제
name: "Caret",                    // 고정된 이름
iconPath: "assets/icons/caret_shell_icon.svg"  // 고정된 경로
```

### 3. 중복/불필요 파일들
- 11개 브랜딩 스크립트 (기능 중복)
- 2가지 다른 설정 파일 형식
- 분산된 테스트 파일들
- 166개+ 백업 파일 누적

## 🌟 새로운 통합 브랜딩 시스템 설계

### 1. 단일 통합 구조
```
caret-b2b/
├── brands/                      # 브랜드별 독립 관리
│   ├── cline/
│   │   └── assets/icons/        # 원본 cline 이미지
│   ├── caret/
│   │   ├── brand-config.json    # caret ↔ cline 매핑
│   │   └── assets/icons/        # caret 이미지  
│   └── codecenter/
│       ├── brand-config.json    # codecenter ↔ caret 매핑
│       └── assets/icons/        # codecenter 이미지
├── backups/                     # 통합 백업 관리
└── tools/
    └── brand-converter.js       # 단일 통합 스크립트
```

### 2. 통합 스크립트 인터페이스
```bash
# 브랜드 기준 방향 지정 (최종 결정된 스펙)
node caret-b2b/tools/brand-converter.js caret forward   # caret config의 정방향 (caret→cline)
node caret-b2b/tools/brand-converter.js caret backward  # caret config의 역방향 (cline→caret)
node caret-b2b/tools/brand-converter.js codecenter forward   # codecenter config의 정방향 (caret→codecenter)
node caret-b2b/tools/brand-converter.js codecenter backward  # codecenter config의 역방향 (codecenter→caret)

# 상태 확인
node caret-b2b/tools/brand-converter.js --status   # 현재 브랜드 확인
```

### 3. 통합 brand-config.json 형식
```json
{
  "metadata": {
    "brand": "codecenter",
    "target": "caret",
    "description": "CodeCenter ↔ Caret branding conversion"
  },
  "mappings": {
    "codecenter": "caret",
    "CodeCenter": "Caret", 
    "codecenter.team": "caret.team"
  },
  "package_fields": ["displayName", "description", "author.name"],
  "terminal": {
    "name": "CodeCenter",
    "icon_file": "codecenter_shell_icon.svg"
  }
}
```

## 🚀 구현 계획

### Phase 1: 구조 통합 (우선순위: 최고)

#### 1.1 브랜드 디렉토리 구축
- [ ] `cline-latest/assets/icons/` → `brands/cline/assets/icons/` 복사
- [ ] `assets/icons/` → `brands/caret/assets/icons/` 복사  
- [ ] `assets/brand-config.json` → `brands/caret/brand-config.json` 이동
- [ ] codecenter `brand.json` → `brand-config.json` 형식 통일

#### 1.2 단일 브랜드 변환 스크립트 구현
```javascript
// brand-converter.js 핵심 기능
class BrandConverter {
  detectCurrentBrand()     // 현재 브랜드 자동 감지
  loadBrandConfig(brand)   // 브랜드별 설정 로드
  convertText(mappings)    // 텍스트 매핑 변환
  copyAssets(from, to)     // 이미지 파일 복사
  updateTerminal(config)   // 터미널 이름/아이콘 업데이트
  executeConversion(from, to) // 통합 변환 실행
}
```

#### 1.3 터미널 브랜딩 수정
**파일**: `src/integrations/terminal/TerminalRegistry.ts`
```javascript
// 기존 (하드코딩)
name: "Caret",
iconPath: "assets/icons/caret_shell_icon.svg"

// 개선 (동적)
name: getBrandName(),  // 현재 브랜드에 따라 동적
iconPath: getBrandTerminalIcon()  // 현재 브랜드 아이콘 경로
```

### Phase 2: 기존 파일 정리

#### 2.1 삭제 대상 (11개 파일)
- [x] `cline-brand-change.js` → `brand-converter.js`로 통합
- [x] `codecenter-brand.js` → 통합
- [x] `universal-brand.js` → 통합  
- [x] `image-resource-conversion.js` → 통합
- [x] `image-path-toggle.js` → 통합
- [x] `b2b-brands-change.js` → 통합
- [x] 관련 테스트 파일 5개 → 단일 테스트로 통합

#### 2.2 설정 파일 통일
- [x] `assets/brand-config.json` → `brands/caret/`로 이동
- [x] `brands/codecenter/brand.json` → `brand-config.json` 형식 변경

#### 2.3 백업 시스템 정리  
```
기존: 166개+ 분산 백업 파일
개선: brands/{brand}/backups/ 브랜드별 관리
```

### Phase 3: 검증 및 테스트

#### 3.1 TDD 테스트 구조
```javascript
describe('Unified Brand Converter', () => {
  test('브랜드 자동 감지')
  test('caret ↔ cline 양방향 변환') 
  test('caret ↔ codecenter 양방향 변환')
  test('터미널 이름/아이콘 업데이트')
  test('에러 상황 처리')
})
```

#### 3.2 실제 변환 테스트
- [ ] caret → cline 변환 + 터미널 확인
- [ ] cline → caret 변환 + 터미널 확인  
- [ ] caret → codecenter 변환 + 터미널 확인
- [ ] codecenter → caret 변환 + 터미널 확인

## 🎯 예상 효과

### 1. 복잡성 대폭 감소
- **11개 스크립트** → **1개 통합 스크립트**
- **2가지 설정 형식** → **1가지 통일 형식** 
- **복잡한 명령어** → **직관적 인터페이스**

### 2. 유지보수성 향상
- 새 브랜드 추가: 폴더 + JSON 1개만 생성
- 버그 수정: 단일 스크립트에서만 수정
- 테스트: 통합된 테스트 체계

### 3. 사용성 개선
- 터미널 이름/아이콘 완전 브랜딩
- 직관적 명령어 구조
- 자동 브랜드 감지

## ✅ 현재 완료 상황 (2025-08-31 19:00 KST)

### 완료된 작업
- [x] **통합 브랜딩 시스템**: `brand-converter.js` 완전 구현 및 검증 완료
- [x] **forward/backward 방식**: 명령어 인터페이스 완전 구현
- [x] **100% 테스트 통과**: 7/7 테스트 성공률 달성
- [x] **CHANGELOG 기반 버전 매핑**: 동적 버전 변환 (caret v0.1.3 ↔ cline v3.26.6)
- [x] **포괄적 변환 범위**: package.json 전체 섹션 (42개+ 필드 변환)
- [x] **중첩 매핑 해결**: 길이순 정렬로 매핑 충돌 방지
- [x] **3-브랜드 지원**: cline ↔ caret ↔ codecenter 완전 구현
- [x] **터미널 브랜딩**: TerminalRegistry.ts 완전 브랜딩 적용
- [x] **실제 파일 변환 검증**: 모든 핵심 파일 변환 상태 확인

### 완성된 기능
1. **자동 브랜드 감지**: package.json 기반 현재 브랜드 자동 인식
2. **양방향 변환**: cline ↔ caret, caret ↔ codecenter 완벽 지원  
3. **매핑 검증 시스템**: 중첩, 순환참조, 빈 값 등 포괄적 검증
4. **이미지 자동 복사**: 브랜드별 아이콘 파일 자동 교체
5. **규칙 파일 경로 변환**: .clinerules ↔ .caretrules 자동 처리
6. **자동 빌드 통합**: 변환 후 자동 컴파일 실행

### 사용법 (완성)
```bash
# 현재 브랜드 확인
node caret-b2b/tools/brand-converter.js --status

# caret 설정 기반 변환
node caret-b2b/tools/brand-converter.js caret forward   # caret → cline
node caret-b2b/tools/brand-converter.js caret backward  # cline → caret

# codecenter 설정 기반 변환  
node caret-b2b/tools/brand-converter.js codecenter forward   # caret → codecenter
node caret-b2b/tools/brand-converter.js codecenter backward  # codecenter → caret
```

## 📋 다음 단계 활용 방안

### ✅ 머징 작업 최적화
1. **머징 전 cline 변환**: 충돌 최소화를 위해 caret → cline 변환
2. **머징 후 caret 복원**: 새로운 기능 추가 후 cline → caret 변환
3. **신기능 매핑 업데이트**: brand-config.json 파일 업데이트로 대응

### ✅ B2B 브랜딩 확장성
- **새 브랜드 추가**: brands/[신규브랜드]/ 폴더 + brand-config.json 생성
- **매핑 확장**: 새 UI 요소, 명령어 등을 brand-config.json에 추가
- **테스트 자동화**: 새 브랜드도 동일한 테스트 체계 적용

## 🔄 작업 우선순위

1. **최우선**: 터미널 브랜딩 수정 (TerminalRegistry.ts)
2. **우선**: 단일 브랜드 변환 스크립트 구현
3. **중요**: 브랜드 디렉토리 구조 통합
4. **일반**: 기존 파일 정리 및 테스트

**목표 완료일**: 2025-08-31 말까지 모든 브랜드 변환이 단일 명령어로 동작