# üîó Caret Link Management System Guide

Caret's integrated link management system is a powerful tool for consistently managing URLs throughout the project and providing different links for each language.

## üìã System Overview

### Problems Solved

- **Duplicate URL Management**: Resolves the issue of hardcoded URLs scattered across multiple components.
- **Multilingual Link Support**: Meets the requirement to provide different URLs for each language.
- **Maintainability**: Centralized management where a link change requires modification in only one place.
- **Type Safety**: Link key validation through TypeScript.

### Core Components

1. **URL Constant Definitions** (`webview-ui/src/caret/utils/urls.ts`)
2. **i18n Integration** (`webview-ui/src/caret/utils/i18n.ts`)
3. **Template Variable System**
4. **Type Safety Assurance**

## üìÅ File Structure

```
webview-ui/src/caret/
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îú‚îÄ‚îÄ urls.ts                # URL constant definitions
‚îÇ   ‚îú‚îÄ‚îÄ CaretWebviewLogger.ts       # Webview logging system 
‚îÇ   ‚îî‚îÄ‚îÄ i18n.ts                # Translation & link integration utility (to be added)
‚îú‚îÄ‚îÄ locale/                    # Multilingual JSON files (to be added)
‚îÇ   ‚îú‚îÄ‚îÄ ko/welcome.json        # Korean translation (with template variables)
‚îÇ   ‚îú‚îÄ‚îÄ en/welcome.json        # English translation
‚îÇ   ‚îú‚îÄ‚îÄ ja/welcome.json        # Japanese translation
‚îÇ   ‚îî‚îÄ‚îÄ zh/welcome.json        # Chinese translation
‚îî‚îÄ‚îÄ components/                # Caret components (to be added)
    ‚îú‚îÄ‚îÄ CaretWelcome.tsx       # Link system usage example
    ‚îî‚îÄ‚îÄ CaretFooter.tsx        # Link system usage example
```

## üîß URL Constant Definition

### General URL Constants (Language-independent)

```typescript
// webview-ui/src/caret/utils/urls.ts
export const CARET_URLS = {
	// Service-related (language-independent)
	CARET_SERVICE: "https://caret.team",
	CARET_GITHUB: "https://github.com/aicoding-caret/caret",

	// Company-related (language-independent)
	CARETIVE_COMPANY: "https://caretive.ai",
	CARETIVE_ABOUT: "https://caretive.ai/about",
	// ... other URLs
} as const
```

### Language-Specific URL Constants

```typescript
// For links that differ by language
export const CARET_LOCALIZED_URLS = {
	// Education program link (different anchors per language)
	EDUCATION_PROGRAM: {
		ko: "https://github.com/aicoding-caret/multi-post-agent/blob/main/docs/education-scenario.md#2-%EA%B0%9C%EB%B0%9C-%ED%99%98%EA%B2%BD-%EC%84%A4%EC%A0%95-%EC%95%BD-30%EB%B6%84",
		en: "https://github.com/aicoding-caret/multi-post-agent/blob/main/docs/education-scenario.md#2-development-environment-setup-approximately-30-minutes",
		ja: "https://github.com/aicoding-caret/multi-post-agent/blob/main/docs/education-scenario.md#2-%E9%96%8B%E7%99%BA%E7%92%B0%E5%A2%83%E8%A8%AD%E5%AE%9A-%E7%B4%8430%E5%88%86",
		zh: "https://github.com/aicoding-caret/multi-post-agent/blob/main/docs/education-scenario.md#2-development-environment-setup-approximately-30-minutes",
	},

	// Gemini credit guide (different documents per language)
	GEMINI_CREDIT_GUIDE: {
		ko: "https://blog.naver.com/fstory97/223887376667",
		en: "https://cloud.google.com/pricing/free-trial",
		ja: "https://cloud.google.com/pricing/free-trial",
		zh: "https://cloud.google.com/pricing/free-trial",
	},
} as const
```

## üåç i18n Integration System

### Helper Functions

```typescript
// webview-ui/src/caret/utils/i18n.ts

// Get the appropriate link for the current language
export function getLocalizedUrl(key: CaretLocalizedUrlKey, language: SupportedLanguage = "ko"): string {
	const urlMap = CARET_LOCALIZED_URLS[key]
	return urlMap[language] || urlMap.ko // fallback to Korean
}

// Get a general URL
export function getUrl(key: CaretUrlKey): string {
	return CARET_URLS[key]
}

// Get a link directly from translation text
export const getLink = (key: CaretLocalizedUrlKey, language?: SupportedLanguage): string => {
	return getLocalizedUrl(key, language || getCurrentLanguage())
}

export const getGlobalLink = (key: CaretUrlKey): string => {
	return getUrl(key)
}
```

### Template Variable System

You can dynamically insert links in translation JSON files using the `{{variableName}}` format:

```json
{
	"educationOffer": {
		"header": "‚ú® Start Now! Free 'Vibe Coding' Education Program!",
		"body": "Participate in our hands-on training program with Caret! <VSCodeLink href=\"{{educationLink}}\">Learn More</VSCodeLink>"
	}
}
```

Supported template variables:

- `{{educationLink}}` ‚Üí Education program link for the current language
- `{{geminiCreditLink}}` ‚Üí Gemini credit guide link for the current language
- `{{caretGitLink}}` ‚Üí Caret GitHub link for the current language
- `{{caretService}}` ‚Üí Caret service link
- `{{caretGithub}}` ‚Üí Caret GitHub link
- `{{caretiveCompany}}` ‚Üí Caretive company link

## üí° Usage

### Using Links Directly in Components

```tsx
import { getGlobalLink, getLink } from "../utils/i18n"

const MyComponent: React.FC = () => {
	return (
		<div>
			{/* General link (language-independent) */}
			<a href={getGlobalLink("CARET_SERVICE")}>Caret Service</a>

			{/* Language-specific link */}
			<a href={getLink("EDUCATION_PROGRAM")}>Education Program</a>
		</div>
	)
}
```

### Automatic Link Replacement via Translation Text

```tsx
import { t } from "../utils/i18n"

const MyComponent: React.FC = () => {
	return (
		<div>
			{/* Template variable is automatically replaced with the actual link */}
			<p
				dangerouslySetInnerHTML={{
					__html: t("educationOffer.body", "welcome"),
				}}
			/>
		</div>
	)
}
```

## üõ†Ô∏è Adding a New Link

### 1. Add a General Link (Language-independent)

```typescript
// webview-ui/src/caret/utils/urls.ts
export const CARET_URLS = {
	// ... existing links
	NEW_SERVICE_LINK: "https://example.com/new-service",
} as const
```

### 2. Add a Language-Specific Link

```typescript
// webview-ui/src/caret/utils/urls.ts
export const CARET_LOCALIZED_URLS = {
	// ... existing links
	NEW_LOCALIZED_LINK: {
		ko: "https://example.com/ko/new-feature",
		en: "https://example.com/en/new-feature",
		ja: "https://example.com/ja/new-feature",
		zh: "https://example.com/zh/new-feature",
	},
} as const
```

### 3. Add a Template Variable

```typescript
// Add to the replaceTemplateVariables function in webview-ui/src/caret/utils/i18n.ts
const replaceTemplateVariables = (text: string, language: SupportedLanguage): string => {
	return (
		text
			// ... existing replacements
			.replace(/\{\{newTemplateVar\}\}/g, getLocalizedUrl("NEW_LOCALIZED_LINK", language))
	)
}
```

### 4. Use in a Translation File

```json
{
	"mySection": {
		"title": "New Feature",
		"description": "Learn more about our new feature <VSCodeLink href=\"{{newTemplateVar}}\">here</VSCodeLink>!"
	}
}
```

## üîç Type Safety

Type safety for link keys is guaranteed through TypeScript:

```typescript
// Typos or non-existent keys are caught at compile time
getGlobalLink("NONEXISTENT_KEY") // ‚ùå Type Error!
getGlobalLink("CARET_SERVICE") // ‚úÖ OK

getLink("INVALID_LOCALIZED_KEY") // ‚ùå Type Error!
getLink("EDUCATION_PROGRAM") // ‚úÖ OK
```

## üìã Best Practices

### 1. Link Classification Principle

- **CARET_URLS**: For fixed links independent of language (service URLs, API endpoints, etc.).
- **CARET_LOCALIZED_URLS**: For links that differ by language (documentation, guides, anchors, etc.).

### 2. Naming Conventions

- Constant names: `SCREAMING_SNAKE_CASE`
- Use meaningful names (e.g., `EDUCATION_PROGRAM` vs. `LINK1`)
- Consider category prefixes (e.g., `DOCS_`, `API_`, `SERVICE_`)

### 3. Template Variable Usage Guide

- Prioritize for links embedded within translated text.
- Variable names in camelCase (e.g., `{{educationLink}}`).
- Use helper functions directly when a link is needed directly in a component.

### 4. Managing Language-Specific Links

- Provide links for all supported languages.
- Fallback to Korean if a translation is missing.
- Consider differences in anchor IDs per language.

## ‚úÖ Checklist

When adding a new link, verify the following:

- [ ] Added to URL constants (`CARET_URLS` or `CARET_LOCALIZED_URLS`)
- [ ] Type definition is automatically updated
- [ ] Added to `replaceTemplateVariables` if a template variable is needed
- [ ] Links provided for all supported languages (if language-specific)
- [ ] Template variable used in translation files (if needed)
- [ ] Webview build test (`npm run build:webview`)
- [ ] Actual link functionality is confirmed

---

## üîó Related Documents

- [Caret Internationalization (i18n) Guide](../../features/f02-multilingual-i18n.mdx)
- [Webview-Extension Communication](./webview-extension-communication.mdx)
- [Development Guide Index](./index.mdx)
