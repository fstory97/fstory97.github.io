# 미션 브리핑: f07 - JSON 시스템 프롬프트 머징

## 1. 미션 목표

`caret-main` 브랜치에서 이미 구현 및 검증 완료된 **JSON 기반의 동적 시스템 프롬프트**를 현재 `cline-latest` 기반의 `caret-merging` 프로젝트에 성공적으로 이식(merging)한다.

## 2. 배경 및 컨텍스트

- **Caret JSON 시스템의 우수성**: 기존 시스템은 `caret-main`에서 실제 운영 및 성능 테스트를 통해 이전 버전의 Cline 하드코딩 프롬프트(707라인) 대비 우수함이 **실험적으로 검증**되었다. (토큰 효율성 15% 향상, 모듈성, 확장성 확보)
- **`cline-latest`의 발전 가능성**: 머징 대상인 `cline-latest`는 기존 Cline보다 `plan`/`act` 모드 등이 개선되었을 가능성이 있다. 따라서 단순 덮어쓰기 방식의 이식은 `cline-latest`의 잠재적 개선점을 유실시킬 위험이 있다.
- **구조적 차이**: `caret-merging` 프로젝트의 기반이 되는 `cline-latest`는 `caret-main` 개발 당시의 Cline 버전과 구조가 다를 수 있어, 단순 파일 복사 방식의 이식은 불가능하다.

## 3. 핵심 구현 원칙 (AI 행동 철학)

이번 머징을 통해 구현해야 할 AI의 행동 원칙은 다음과 같다.

- **`chatbot` 모드 (개발자 주도 조언 모드)**:
    - AI는 전문가로서 분석과 가이드를 제공한다.
    - 코드베이스를 직접 수정하는 등의 실행(execution) 도구 사용은 **제한**된다.
    - 개발자의 판단을 돕는 '컨설턴트' 역할을 수행한다.

- **`agent` 모드 (페어 코딩 모드)**:
    - 단순한 `act` 모드를 넘어, **원활한 대화와 협의**가 가능한 '협력적 개발 파트너' 역할을 수행한다.
    - 성급하게 행동하지 않고, **분석을 기반으로 신중하게** 작업을 제안하고 실행한다.
    - 자동화 지시를 받았을 때는 효율적으로 작업을 수행하되, 사용자의 **중단(interrupt)에 즉시 반응하고 협의**할 수 있어야 한다.

## 4. 전략적 접근 방안

1.  **Phase 0: 현황 분석 (As-Is Analysis)**
    - **목표**: `cline-latest`의 시스템 프롬프트 구조를 파악하여 안전한 통합 지점(integration point)을 식별한다.
- **실행**:
    1. `cline-latest/src/core/prompts/` 디렉토리의 구조와 프롬프트 빌드 관련 핵심 로직을 분석한다.
    2. **(중요)** `cline-latest`의 신규 컴포넌트(`TODO` 등 3개)를 제외한 나머지 컴포넌트들의 총 토큰(또는 문자) 양과, 그에 대응하는 Caret의 JSON 섹션들의 총 토큰 양을 비교하여, **Caret 시스템의 토큰 효율성 우위가 여전히 유효한지 검증**한다.

2.  **Phase 1: 핵심 시스템 이식 (Core System Migration)**
    - **목표**: 검증된 Caret의 JSON 시스템(어셈블러, 18개 섹션 파일, 테스트 등)을 `caret-src` 디렉토리로 안전하게 이식한다.

3.  **Phase 2: 시스템 통합 및 행동 원칙 적용 (Integration & Principle Application)**
    - **목표**: 분석 단계에서 식별한 통합 지점에 Caret JSON 시스템을 연결하고, '핵심 구현 원칙'에 명시된 `chatbot`/`agent` 모드의 행동 철학을 프롬프트 로직에 반영한다.

4.  **Phase 3: 검증 (Verification)**
    - **목표**: 이식된 시스템이 기술적으로 올바르게 동작하고, 정의된 행동 원칙을 완벽하게 수행하는지 확인한다.
    - **실행**: 단위/통합 테스트 및 실제 VSCode 환경에서의 기능 테스트를 수행한다.

## 5. 당면 과제 (Immediate Task)

**`Phase 0: 현황 분석`** 을 시작한다. `cline-latest/src/core/prompts/` 디렉토리의 파일 목록을 확인하여 구조적 변경점을 파악하는 것부터 진행한다.
