# f08 - Chatbot/Agent ëª¨ë“œ ì‹œìŠ¤í…œ ë¨¸ì§• ì‘ì—…

## ê¸°ëŠ¥ ê°œìš”
- **ëª©ì **: Cline Plan/Act ëª¨ë“œë¥¼ ì™„ì „íˆ ìƒˆë¡œìš´ ë°©ì‹ìœ¼ë¡œ ì¬í•´ì„í•œ ë…ë¦½ì  AI ìƒí˜¸ì‘ìš© ì‹œìŠ¤í…œ
- **í˜„ì¬ ìƒíƒœ**: âœ… ì™„ì „ êµ¬í˜„ ì™„ë£Œ (Level 1 ë…ë¦½ ëª¨ë“ˆ ë‹¬ì„±)
- **ìš°ì„ ìˆœìœ„**: HIGH - ì‚¬ìš©ì ê²½í—˜ í˜ì‹  ë° ì°¨ë³„í™” í•µì‹¬

## ì£¼ìš” êµ¬ì„± ìš”ì†Œ

### Plan/Act vs Chatbot/Agent ì°¨ì´ì 

| êµ¬ë¶„            | Cline Plan/Act               | Caret Chatbot/Agent              |
| --------------- | ---------------------------- | -------------------------------- |
| **ê²½í—˜ ë°©ì‹**   | ë¶„ì ˆëœ ê²½í—˜ (ê³„íšâ†’ìŠ¹ì¸â†’ì‹¤í–‰) | ë‹¨ì¼ ì—°ì† ê²½í—˜ (ìì—°ìŠ¤ëŸ¬ìš´ ëŒ€í™”) |
| **AI ì—­í• **     | ë„êµ¬ ì‚¬ìš© ì¤‘ì‹¬               | ëŒ€í™”ì™€ í˜‘ì—… ì¤‘ì‹¬                 |
| **ì‚¬ìš©ì ê´€ì ** | ê¸°ìˆ ì  ìš©ì–´ (Plan/Act)       | ì§ê´€ì  ìš©ì–´ (Chatbot/Agent)      |

### AI í–‰ë™ íŒ¨í„´

#### ğŸ¤– Chatbot Mode (ìƒë‹´ì‚¬ ì—­í• )
- **AI íƒœë„**: "ì´ ë°©ë²•ì€ ì–´ë– ì‹ ê°€ìš”?", "ë” ê¶ê¸ˆí•œ ì ì´ ìˆìœ¼ì‹ ê°€ìš”?"
- **ì£¼ë„ê¶Œ**: ê°œë°œìê°€ ì£¼ë„, AIëŠ” ì¡°ì–¸ê³¼ ë¶„ì„ë§Œ ì œê³µ
- **ì•ˆì „ì„±**: ìœ„í—˜í•œ ì‘ì—…(íŒŒì¼ ìˆ˜ì •, ëª…ë ¹ ì‹¤í–‰) ì°¨ë‹¨
- **ìš©ë„**: ì½”ë“œ ë¦¬ë·°, ê¸°ìˆ  ìƒë‹´, ì•„í‚¤í…ì²˜ ì¡°ì–¸

#### âš¡ Agent Mode (í˜‘ë ¥ íŒŒíŠ¸ë„ˆ ì—­í• )
- **AI íƒœë„**: "ì´ ì‘ì—…ì„ ì§„í–‰í•˜ê² ìŠµë‹ˆë‹¤", "ë‹¤ìŒ ë‹¨ê³„ë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤"
- **ì£¼ë„ê¶Œ**: AIê°€ ì£¼ë„, ëª¨ë“  ê°œë°œ ì‘ì—… ì§ì ‘ ìˆ˜í–‰
- **ììœ ë„**: ëª¨ë“  ë„êµ¬ ì‚¬ìš© + ììœ ë¡œìš´ ëŒ€í™” ê°€ëŠ¥
- **ìš©ë„**: ê¸°ëŠ¥ êµ¬í˜„, ë²„ê·¸ ìˆ˜ì •, ìë™í™” ì‘ì—…

## ì°¨ë³„í™” í¬ì¸íŠ¸
- **ì™„ì „ ë…ë¦½ì„±**: Plan/Act ì½”ë“œì™€ 0% ì˜ì¡´ì„±
- **ì–´ëŒ‘í„° íŒ¨í„´**: Cline ì¸í”„ë¼ ì¬ì‚¬ìš©í•˜ë˜ ì™„ì „íˆ ë‹¤ë¥´ê²Œ í•´ì„
- **ì´ì¤‘ ë³´ì•ˆ**: JSON í”„ë¡¬í”„íŠ¸ + ì‹¤í–‰ì‹œì  ì°¨ë‹¨ìœ¼ë¡œ Chatbot ëª¨ë“œ ì•ˆì „ì„± ë³´ì¥
- **Factory íŒ¨í„´**: Caret/Cline ì‹œìŠ¤í…œ ì™„ì „ ë¶„ë¦¬

## ë¨¸ì§• ê³„íš 

### Phase 1: TDD í…ŒìŠ¤íŠ¸ í™˜ê²½ êµ¬ì¶•
- [ ] ì–´ëŒ‘í„° íŒ¨í„´ í…ŒìŠ¤íŠ¸ ì´ì‹
  ```bash
  cp -r caret-main/caret-src/core/mode-system/__tests__ \
        caret-src/core/mode-system/__tests__
  ```
- [ ] í…ŒìŠ¤íŠ¸ ì‹¤í–‰ í™•ì¸
  ```bash
  npm run test:backend -- mode-system
  ```

### Phase 2: ì–´ëŒ‘í„° íŒ¨í„´ ì‹œìŠ¤í…œ ì´ì‹
- [ ] ModeSystemRegistry ì´ì‹
  ```bash
  cp caret-main/caret-src/core/mode-system/ModeSystemRegistry.ts \
     caret-src/core/mode-system/
  ```
- [ ] ìƒìˆ˜ ì‹œìŠ¤í…œ ì´ì‹
  ```bash
  cp caret-main/caret-src/shared/constants/ModeSystemConstants.ts \
     caret-src/shared/constants/
  ```

### Phase 3: JSON í”„ë¡¬í”„íŠ¸ ì‹œìŠ¤í…œ ì´ì‹ (f07 í†µí•©)
- [ ] JSON ì„¹ì…˜ ì–´ì…ˆë¸”ëŸ¬ ì´ì‹
  ```bash
  cp -r caret-main/caret-src/core/prompts/ \
        caret-src/core/prompts/
  ```
- [ ] 18ê°œ JSON ì„¹ì…˜ ì´ì‹ (f07ê³¼ ê³µí†µ)

### Phase 4: ë„êµ¬ ì œí•œ ì‹œìŠ¤í…œ ì´ì‹
- [ ] ë„êµ¬ í•¸ë“¤ëŸ¬ ì´ì‹
  ```bash
  cp caret-main/caret-src/core/tools/CaretToolHandler.ts \
     caret-src/core/tools/
  
  cp caret-main/caret-src/core/tools/CaretToolSelector.ts \
     caret-src/core/tools/
  ```

### Phase 5: Factory íŒ¨í„´ ë©”ì‹œì§• ì‹œìŠ¤í…œ ì´ì‹
- [ ] ë©”ì‹œì§€ í•¸ë“¤ëŸ¬ íŒ©í† ë¦¬ ì´ì‹
  ```bash
  cp -r caret-main/caret-src/core/messaging/ \
        caret-src/core/messaging/
  ```

### Phase 6: ë°±ì—”ë“œ í†µí•© (ìµœì†Œ ìˆ˜ì •)
- [ ] build-system-prompt.ts ë¶„ê¸° ë¡œì§ ì¶”ê°€ (4ë¼ì¸)
  ```typescript
  // CARET MODIFICATION: modeSystem ê¸°ë°˜ í”„ë¡¬í”„íŠ¸ ë¶„ê¸°
  if (modeSystem === "caret") {
      return await modeRegistry.buildSystemPrompt(modeSystem, mode, context)
  }
  ```
- [ ] task/index.tsì— í™˜ê²½ ì„¸ë¶€ì‚¬í•­ ì¶”ê°€ (1ê°œ ë©”ì„œë“œ)
- [ ] ToolExecutor.tsì— ë„êµ¬ ì œí•œ ê²€ì‚¬ ì¶”ê°€ (5ë¼ì¸)

### Phase 7: í”„ë¡ íŠ¸ì—”ë“œ UI í†µí•©
- [ ] ëª¨ë“œ ì‹œìŠ¤í…œ ì„¤ì • UI ì´ì‹
  ```bash
  cp caret-main/webview-ui/src/caret/components/CaretModeSystemSetting.tsx \
     webview-ui/src/caret/components/
  ```
- [ ] ChatTextArea.tsx ë¼ë²¨ ë³€ê²½ (2ê°œ ìˆ˜ì •)
- [ ] buttonConfig.ts Factory íŒ¨í„´ ì ìš© (2ì¤„ í•µì‹¬ ìˆ˜ì •)

### Phase 8: Proto ì‹œìŠ¤í…œ í™•ì¥
- [ ] state.protoì— modeSystem í•„ë“œ ì¶”ê°€
- [ ] ë³€í™˜ ë¡œì§ ì´ì‹
  ```bash
  cp caret-main/caret-src/shared/proto-conversions/state/caret-settings-conversion.ts \
     caret-src/shared/proto-conversions/state/
  ```

### Phase 9: í†µí•© í…ŒìŠ¤íŠ¸
- [ ] 42ê°œ í†µí•© í…ŒìŠ¤íŠ¸ ì‹¤í–‰
- [ ] 37ê°œ TDD í…ŒìŠ¤íŠ¸ ì‹¤í–‰
- [ ] End-to-End í…ŒìŠ¤íŠ¸
- [ ] UI í˜¸í™˜ì„± í…ŒìŠ¤íŠ¸

## í•µì‹¬ ì•„í‚¤í…ì²˜: ì–´ëŒ‘í„° íŒ¨í„´

### ModeSystemRegistry (ì¤‘ì•™ ì§‘ì¤‘í™”)
```typescript
// ëª©í‘œ: ì–´ëŒ‘í„° íŒ¨í„´ìœ¼ë¡œ ì™„ì „ ë¶„ë¦¬ëœ ì‹œìŠ¤í…œ
interface ModeSystemAdapter {
    // í™˜ê²½ ë° í”„ë¡¬í”„íŠ¸
    getEnvironmentDetails(mode: string): string
    buildSystemPrompt(mode: string, context: any): Promise<string>
    
    // ë„êµ¬ ì²˜ë¦¬
    getResponseToolName(mode: string): string
    handleToolResponse(toolName: string, params: any): Promise<any>
    
    // UI í‘œí˜„
    getModeDisplayName(mode: string): string
    getToggleTarget(currentMode: string): string
}

// ì¤‘ì•™ ë ˆì§€ìŠ¤íŠ¸ë¦¬ (ì‹±ê¸€í†¤ íŒ¨í„´)
class ModeSystemRegistry {
    private adapters = new Map<string, ModeSystemAdapter>()
    
    getEnvironmentDetails(modeSystem: string, mode: string): string {
        return this.getAdapter(modeSystem).getEnvironmentDetails(mode)
    }
    
    async buildSystemPrompt(modeSystem: string, mode: string, context: any): Promise<string> {
        return this.getAdapter(modeSystem).buildSystemPrompt(mode, context)
    }
}
```

### Caret ì‹œìŠ¤í…œ ì–´ëŒ‘í„° (ë…ë¦½ì  êµ¬í˜„)
```typescript
class CaretModeAdapter implements ModeSystemAdapter {
    getEnvironmentDetails(mode: string): string {
        return mode === "plan"
            ? "\nCHATBOT MODE\nExpert consultation..."
            : "\nAGENT MODE\nCollaborative development..."
    }
    
    async buildSystemPrompt(mode: string, context: any): Promise<string> {
        // JSON ê¸°ë°˜ Caret ì „ìš© í”„ë¡¬í”„íŠ¸ ìƒì„± (f07 í†µí•©)
        const assembler = new JsonSectionAssembler(context.templateLoader)
        return assembler.assembleFinalPrompt(await assembler.loadBaseSections(mode))
    }
}
```

## ì´ì¤‘ ë³´ì•ˆ ë ˆì´ì–´ (Chatbot ëª¨ë“œ ì•ˆì „ì„±)

### Layer 1: JSON ê¸°ë°˜ í”„ë¡¬í”„íŠ¸ í•„í„°ë§
```json
// caret-src/core/prompts/sections/TOOL_DEFINITIONS.json
{
    "execute_command": {
        "mode_restriction": "agent_only"
    },
    "write_to_file": {
        "mode_restriction": "agent_only"
    },
    "replace_in_file": {
        "mode_restriction": "agent_only"
    }
}
```

### Layer 2: ì‹¤í–‰ì‹œì  ìƒìˆ˜ ê¸°ë°˜ ì°¨ë‹¨
```typescript
// caret-src/shared/constants/ModeSystemConstants.ts
export const RESTRICTED_TOOLS = {
    CHATBOT_BLOCKED: ["write_to_file", "replace_in_file", "execute_command"] as const,
    AGENT_ALLOWED: "*" as const,
} as const
```

## Factory íŒ¨í„´ ë©”ì‹œì§• ì‹œìŠ¤í…œ

### MessageHandlerFactory (ì™„ì „ ë¶„ë¦¬)
```typescript
export class MessageHandlerFactory {
    static create(modeSystem: "caret" | "cline"): MessageHandlerInterface {
        return modeSystem === "caret"
            ? new CaretMessageHandler() // ìˆœìˆ˜ Caret ë¡œì§ë§Œ
            : new ClineMessageHandler() // ìˆœìˆ˜ Cline ë¡œì§ë§Œ
    }
}

// Caret ì „ìš© í•¸ë“¤ëŸ¬ (Optimistic Update í¬í•¨)
class CaretMessageHandler implements MessageHandlerInterface {
    async handleSendMessage(text: string, images: string[], files: string[], clineAsk?: string, messagesLength?: number) {
        // Optimistic UI Update êµ¬í˜„ ì™„ë£Œ
        this.addOptimisticUserMessage(text)
        
        // Caret ì „ìš©: ììœ ë¡œìš´ ëŒ€í™”, Agent ëª¨ë“œ ì§€ì›
        if (this.isNewConversation(messagesLength)) {
            return TaskServiceClient.newTask({ text, images, files })
        } else {
            return TaskServiceClient.askResponse({
                responseType: "messageResponse",
                text,
                images,
                files,
            })
        }
    }
}
```

## ì‹¤ì œ êµ¬í˜„ëœ íŒŒì¼ êµ¬ì¡°

```
í”„ë¡œì íŠ¸ ë£¨íŠ¸/
â”œâ”€â”€ src/ (Cline ìµœì†Œ ìˆ˜ì • - 5ê°œ í•µì‹¬ íŒŒì¼ë§Œ)
â”‚   â”œâ”€â”€ core/task/
â”‚   â”‚   â””â”€â”€ ToolExecutor.ts                       # ì´ì¤‘ ë³´ì•ˆ: isCaretToolRestricted() ë©”ì„œë“œ (5ë¼ì¸)
â”‚   â”œâ”€â”€ core/prompts/system-prompt/
â”‚   â”‚   â””â”€â”€ build-system-prompt.ts                # modeRegistry ë¶„ê¸° ë¡œì§ (4ë¼ì¸)
â”‚   â””â”€â”€ core/controller/state/
â”‚       â””â”€â”€ updateSettings.ts                     # CaretSettings ì²˜ë¦¬ (4ë¼ì¸)

â”œâ”€â”€ caret-src/ (Caret ì™„ì „ ë…ë¦½ ì‹œìŠ¤í…œ)
â”‚   â”œâ”€â”€ shared/
â”‚   â”‚   â”œâ”€â”€ CaretSettings.ts                      # ë…ë¦½ì ì¸ ì„¤ì • íƒ€ì…
â”‚   â”‚   â”œâ”€â”€ constants/
â”‚   â”‚   â”‚   â””â”€â”€ ModeSystemConstants.ts            # ëª¨ë“  í•˜ë“œì½”ë”© ë¬¸ìì—´ ìƒìˆ˜í™”
â”‚   â”‚   â””â”€â”€ proto-conversions/state/
â”‚   â”‚       â””â”€â”€ caret-settings-conversion.ts      # Caretâ†”Cline ë³€í™˜ ë¡œì§
â”‚   â”‚
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ mode-system/                          # ì–´ëŒ‘í„° íŒ¨í„´ ì‹œìŠ¤í…œ
â”‚   â”‚   â”‚   â”œâ”€â”€ ModeSystemRegistry.ts             # ì¤‘ì•™ ì§‘ì¤‘ì‹ ëª¨ë“œ ê´€ë¦¬
â”‚   â”‚   â”‚   â””â”€â”€ __tests__/                        # 42ê°œ í†µí•© í…ŒìŠ¤íŠ¸
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ prompts/                              # JSON í”„ë¡¬í”„íŠ¸ ì‹œìŠ¤í…œ (f07 í†µí•©)
â”‚   â”‚   â”‚   â”œâ”€â”€ JsonSectionAssembler.ts           # JSON ê¸°ë°˜ í”„ë¡¬í”„íŠ¸ ì¡°ë¦½
â”‚   â”‚   â”‚   â”œâ”€â”€ JsonTemplateLoader.ts             # í…œí”Œë¦¿ ë¡œë”© ì‹œìŠ¤í…œ
â”‚   â”‚   â”‚   â”œâ”€â”€ CaretSystemPrompt.ts              # ë…ë¦½ì  ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸
â”‚   â”‚   â”‚   â””â”€â”€ sections/                         # 18ê°œ JSON ì„¹ì…˜
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ messaging/                            # Factory íŒ¨í„´ ë©”ì‹œì§•
â”‚   â”‚   â”‚   â”œâ”€â”€ MessageHandlerFactory.ts          # íŒ©í† ë¦¬ ì§„ì…ì 
â”‚   â”‚   â”‚   â”œâ”€â”€ CaretMessageHandler.ts            # Caret ì „ìš© ë¡œì§
â”‚   â”‚   â”‚   â”œâ”€â”€ ButtonConfigFactory.ts            # ë²„íŠ¼ ì„¤ì • íŒ©í† ë¦¬
â”‚   â”‚   â”‚   â”œâ”€â”€ CaretButtonConfigHandler.ts       # Caret ë²„íŠ¼ ë¡œì§
â”‚   â”‚   â”‚   â””â”€â”€ interfaces/
â”‚   â”‚   â”‚       â””â”€â”€ MessageHandlerInterface.ts    # ê³µí†µ ì¸í„°í˜ì´ìŠ¤
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ tools/                                # JSON ê¸°ë°˜ ë„êµ¬ ì‹œìŠ¤í…œ
â”‚   â”‚       â”œâ”€â”€ CaretToolHandler.ts               # ë„êµ¬ í•„í„°ë§ ë¡œì§
â”‚   â”‚       â”œâ”€â”€ CaretToolSelector.ts              # ì§€ëŠ¥í˜• ë„êµ¬ ì„ íƒ
â”‚   â”‚       â””â”€â”€ __tests__/                        # 12ê°œ ë„êµ¬ í…ŒìŠ¤íŠ¸
â”‚   â”‚
â”‚   â””â”€â”€ __tests__/                                # ì¢…í•© ê²€ì¦ ì‹œìŠ¤í…œ
â”‚       â”œâ”€â”€ integration/                          # End-to-End í…ŒìŠ¤íŠ¸
â”‚       â””â”€â”€ tdd/                                  # TDD í…ŒìŠ¤íŠ¸

â””â”€â”€ webview-ui/src/ (í”„ë¡ íŠ¸ì—”ë“œ - Caret í™•ì¥)
    â”œâ”€â”€ components/chat/
    â”‚   â”œâ”€â”€ ChatTextArea.tsx                      # modeSystem ê¸°ë°˜ ë¼ë²¨ ë³€ê²½ (2ê°œ ìˆ˜ì •)
    â”‚   â”œâ”€â”€ ChatRow.tsx                           # chatbot_mode_respond UI ì²˜ë¦¬ (5ê°œ ìˆ˜ì •)
    â”‚   â””â”€â”€ chat-view/
    â”‚       â”œâ”€â”€ hooks/
    â”‚       â”‚   â””â”€â”€ useMessageHandlers.ts         # Factory íŒ¨í„´ ì ìš© (1ì¤„ë§Œ ìˆ˜ì •)
    â”‚       â””â”€â”€ shared/
    â”‚           â”œâ”€â”€ buttonConfig.ts               # Agent ëŒ€í™” íë¦„ ì™„ì„± (2ì¤„ í•µì‹¬ ìˆ˜ì •)
    â”‚           â””â”€â”€ __tests__/                    # ëŒ€í™” íë¦„ ê²€ì¦ í…ŒìŠ¤íŠ¸
    â””â”€â”€ caret/
        â””â”€â”€ components/
            â””â”€â”€ CaretModeSystemSetting.tsx        # ëª¨ë“œ ì‹œìŠ¤í…œ í† ê¸€ UI (9ê°œ ìˆ˜ì •)
```

## ì‚¬ìš©ì ê²½í—˜

### ëª¨ë“œ ì „í™˜
1. **ë‹¨ì¶•í‚¤ë¡œ ë¹ ë¥¸ ì „í™˜**: `âŒ˜â‡§A` (macOS) ë˜ëŠ” `Ctrl+Shift+A` (Windows/Linux)
2. **UIì—ì„œ ìˆ˜ë™ ì „í™˜**: ì±„íŒ… ì…ë ¥ì°½ ìƒë‹¨ì˜ ëª¨ë“œ í† ê¸€ ë²„íŠ¼ í´ë¦­
3. **ì‹œìŠ¤í…œ ëª¨ë“œ ì„ íƒ**: ì„¤ì •ì—ì„œ Caret ëª¨ë“œ â†” Cline ëª¨ë“œ ì „í™˜ ê°€ëŠ¥

### ëŒ€í™” íë¦„
- **ììœ  ëŒ€í™”**: AI ì‘ë‹µ ì™„ë£Œ í›„ ì¶”ê°€ ì§ˆë¬¸ì´ë‚˜ ìš”ì²­ ê°€ëŠ¥
- **ì—°ì† ëŒ€í™”**: ì´ì „ ëŒ€í™” ë§¥ë½ì„ ìœ ì§€í•˜ë©´ì„œ ì§€ì†ì ì¸ ìƒí˜¸ì‘ìš©
- **ëª¨ë“œ ì „í™˜**: ëŒ€í™” ì¤‘ì—ë„ í•„ìš”ì— ë”°ë¼ ëª¨ë“œ ë³€ê²½ ê°€ëŠ¥

### ìµœì  ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤

#### ğŸ¤– Chatbot Mode í™œìš©
- ì½”ë“œ ë¶„ì„ ë° ë¦¬ë·°
- ì•„í‚¤í…ì²˜ ì„¤ê³„ ìƒë‹´
- ê¸°ìˆ  ì„ íƒ ì¡°ì–¸
- ë””ë²„ê¹… ë¶„ì„
- í•™ìŠµ ë° êµìœ¡

#### âš¡ Agent Mode í™œìš©
- ê¸°ëŠ¥ êµ¬í˜„ ë° ê°œë°œ
- í”„ë¡œì íŠ¸ ì„¤ì • ë° ì´ˆê¸°í™”
- í…ŒìŠ¤íŠ¸ ë° í’ˆì§ˆ ê´€ë¦¬
- ë²„ê·¸ ìˆ˜ì • ë° ë¦¬íŒ©í† ë§
- íŒ¨í‚¤ì§€ ê´€ë¦¬ ë° ë°°í¬

## ì™„ë£Œ í˜„í™© (2025-08-28)

### âœ… ì™„ë£Œëœ í•µì‹¬ ê¸°ëŠ¥ë“¤

#### 1. JSON ê¸°ë°˜ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ (f07 í†µí•© ì™„ì„±)
- `JsonSectionAssembler.ts`: 18ê°œ JSON ì„¹ì…˜ ë¡œë”©
- `CaretSystemPrompt.ts`: Plan/Act ì˜ì¡´ì„± 0% ë‹¬ì„±
- `sections/`: CHATBOT_AGENT_MODES.json ë“± êµ¬ì¡°í™”ëœ í”„ë¡¬í”„íŠ¸

#### 2. ë°±ì—”ë“œ í†µí•© (ì™„ì„±)
- `task/index.ts`: modeSystem ê°ì§€ ë° Environment Details ì²˜ë¦¬
- `build-system-prompt.ts`: Caret ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ë¶„ê¸°
- `ToolExecutor.ts`: chatbot_mode_respond ë„êµ¬ ì²˜ë¦¬

#### 3. í”„ë¡ íŠ¸ì—”ë“œ UI (ì™„ì„±)
- `ChatTextArea.tsx`: modeSystem ê¸°ë°˜ ë¼ë²¨ ì „í™˜ ("Plan/Act" â†” "Chatbot/Agent")
- `CaretModeSystemSetting.tsx`: ì„¤ì • UI í† ê¸€
- localStorage ê¸°ë°˜ ì‹¤ì‹œê°„ ë™ê¸°í™”

#### 4. Proto ì‹œìŠ¤í…œ í™•ì¥ (ì™„ì„±)
- `state.proto`: modeSystem í•„ë“œ ì¶”ê°€
- `caret-settings-conversion.ts`: ëª¨ë“œ ì‹œìŠ¤í…œ ë³€í™˜ ë¡œì§

### ğŸ“Š ìµœì¢… ë‹¬ì„± ì§€í‘œ

| ëª©í‘œ              | ë‹¬ì„±ë„  | ì„¸ë¶€ ì‚¬í•­                                  |
| ----------------- | ------- | ------------------------------------------ |
| **ê¸°ëŠ¥ì  ë…ë¦½ì„±** | âœ… 100% | Plan/Act ì½”ë“œì™€ 0% ì˜ì¡´ì„±                  |
| **ì–´ëŒ‘í„° íŒ¨í„´**   | âœ… 100% | ModeSystemRegistry ì™„ì „ êµ¬í˜„               |
| **Factory íŒ¨í„´**  | âœ… 100% | MessageHandler + ButtonConfig Factory ì™„ì„± |
| **JSON í”„ë¡¬í”„íŠ¸** | âœ… 100% | 18ê°œ ì„¹ì…˜ êµ¬ì¡°í™” ì™„ë£Œ (f07 í†µí•©)          |
| **UI í†µí•©**       | âœ… 100% | ì‹¤ì‹œê°„ ë™ê¸°í™” ì™„ì„±                         |
| **TDD ê²€ì¦**      | âœ… 97%  | 38ê°œ ì¤‘ 37ê°œ í…ŒìŠ¤íŠ¸ í†µê³¼                   |
| **ë¨¸ì§• ì•ˆì „ì„±**   | âœ… 96%  | Cline íŒŒì¼ ìˆ˜ì • 5ê°œë¡œ ìµœì†Œí™” ë‹¬ì„±          |
| **Agent ëª¨ë“œ**    | âœ… 100% | Optimistic Updateë¡œ ì™„ì „ ë™ì‘              |
| **Chatbot ëª¨ë“œ**  | âœ… 100% | ë²„íŠ¼ ë¬¸ì œ í•´ê²°ë¡œ ì™„ì „ ë™ì‘                 |

## Cline í˜¸í™˜ì„±

### ì™„ì „ í˜¸í™˜ì„± ì œê³µ
ê¸°ì¡´ Cline ì‚¬ìš©ìë¥¼ ìœ„í•œ **ì™„ë²½í•œ í•˜ìœ„ í˜¸í™˜ì„±**:

| Caret Mode     | Cline Mode  | ì„¤ëª…           |
| -------------- | ----------- | -------------- |
| **ğŸ’¬ Chatbot** | **ğŸ“‹ Plan** | ëŒ€í™”/ê³„íš ì¤‘ì‹¬ |
| **ğŸ¤– Agent**   | **âš¡ Act**  | ì‹¤í–‰/ì‘ì—… ì¤‘ì‹¬ |

### ë§¤ë„ëŸ¬ìš´ ì „í™˜
- **ê¸°ì¡´ ì‚¬ìš©ì**: ì•„ë¬´ëŸ° ë³€ê²½ ì—†ì´ Plan/Act ëª¨ë“œ ê³„ì† ì‚¬ìš©
- **ìƒˆë¡œìš´ ì‚¬ìš©ì**: ì§ê´€ì ì¸ Chatbot/Agent ëª¨ë“œ í™œìš©
- **í˜¼í•© ì‚¬ìš©**: ì–¸ì œë“ ì§€ Caret â†” Cline ëª¨ë“œ ì „í™˜ ê°€ëŠ¥

## ì£¼ì˜ì‚¬í•­

### ë¨¸ì§• ì‹œ ì£¼ì˜ì‚¬í•­
- [ ] ì–´ëŒ‘í„° íŒ¨í„´: ModeSystemRegistry ì •ìƒ ë™ì‘ í™•ì¸
- [ ] JSON í”„ë¡¬í”„íŠ¸: f07ê³¼ í†µí•© êµ¬í˜„ í™•ì¸
- [ ] Factory íŒ¨í„´: ì™„ì „ ë¶„ë¦¬ ì•„í‚¤í…ì²˜ í™•ì¸
- [ ] ì´ì¤‘ ë³´ì•ˆ: Chatbot ëª¨ë“œ ë„êµ¬ ì œí•œ ì •ìƒ ë™ì‘
- [ ] UI í˜¸í™˜ì„±: Cline Act ëª¨ë“œì™€ ë™ì¼í•œ ë™ì‘ í™•ì¸

### ì™„ë£Œ ê¸°ì¤€
- [ ] 42ê°œ í†µí•© í…ŒìŠ¤íŠ¸ í†µê³¼
- [ ] 37ê°œ TDD í…ŒìŠ¤íŠ¸ í†µê³¼
- [ ] End-to-End í…ŒìŠ¤íŠ¸ í†µê³¼
- [ ] UI í˜¸í™˜ì„± í…ŒìŠ¤íŠ¸ í†µê³¼
- [ ] Agent ëª¨ë“œ ëŒ€í™” ì—°ì†ì„± í™•ì¸
- [ ] Chatbot ëª¨ë“œ ì•ˆì „ ì¥ì¹˜ í™•ì¸
- [ ] ê¸°ì¡´ Cline ì‚¬ìš©ì ì›Œí¬í”Œë¡œìš° 100% ë³´ì¡´

## ì˜ˆìƒ ì†Œìš” ì‹œê°„
- **ì´ ì‹œê°„**: 10-12ì‹œê°„
- **ë³µì¡ë„**: HIGH
- **ìœ„í—˜ë„**: LOW (ì™„ì „ êµ¬í˜„ ì™„ë£Œë¡œ ì•ˆì •ì„± ê²€ì¦ë¨)