---
title: "深度规划命令"
sidebarTitle: "/deep-planning"
---

`/deep-planning` 将 Cline 转变为一个细致的架构师，他会调查您的代码库，询问澄清问题，并在编写任何代码之前创建全面的实施计划。 

<Frame>
	<img
		src="https://storage.googleapis.com/cline_public_images/docs/assets/deep-planning.png"
		alt="深度规划命令实际操作，显示调查和规划过程"
	/>
</Frame>

当您使用 `/deep-planning` 时，Cline 遵循一个四步过程，反映了高级开发者处理复杂功能的方式：彻底调查、讨论和澄清需求、详细规划，以及带有进度跟踪的结构化任务创建。

## 四步过程

### 步骤 1：静默调查

Cline 变成一个侦探，静静地探索您的代码库以了解其结构、模式和约束。他检查源文件，分析导入模式，发现类层次结构，并识别技术债务标记。没有评论，没有叙述 - 只是专注的研究。

在此阶段，Cline 运行诸如以下命令：
- 查找代码库中的所有类和函数定义
- 分析导入模式以了解依赖关系
- 发现项目结构和文件组织
- 识别 TODO 和技术债务

### 步骤 2：讨论和提问

一旦 Cline 了解您的代码库，他会询问将塑造实现的有针对性的问题。这些不是通用问题 - 它们特定于您的项目和您正在构建的功能。

问题可能涵盖：
- 澄清模糊的需求
- 在同等有效的实现方法之间进行选择
- 确认关于系统行为的假设
- 了解技术决策的偏好

### 步骤 3：实施计划文档

Cline 创建一个结构化的 markdown 文档（`implementation_plan.md`），作为您的实施蓝图。这不是模糊的大纲 - 它是具有确切文件路径、函数签名和实施顺序的详细规范。

该计划包括八个综合部分：
- **概述**：目标和高级方法
- **类型**：完整的类型定义和数据结构
- **文件**：要创建、修改或删除的确切文件
- **函数**：带有签名的新函数和修改函数
- **类**：类修改和继承详细信息
- **依赖关系**：包需求和版本
- **测试**：验证策略和测试需求
- **实施顺序**：逐步执行序列

### 步骤 4：实施任务创建

Cline 创建一个引用计划文档并包含可跟踪实施步骤的新任务。该任务附带用于读取计划各个部分的特定命令，确保实施代理（无论是您还是在行动模式下的 Cline）可以高效地导航蓝图。

<Tip>
  深度规划与[焦点链](/features/focus-chain)配合得很好。实施步骤自动成为带有实时进度跟踪的待办事项列表，保持复杂项目的有序和正轨。
</Tip>

## 使用深度规划

通过输入 `/deep-planning` 后跟您的功能描述来开始深度规划会话：

```
/deep-planning 添加带有 JWT 令牌和基于角色访问控制的用户身份验证
```

Cline 将立即开始他的调查。您将看到他读取文件并运行命令来了解您的代码库。一旦他收集了足够的上下文，他就会在创建计划之前与您展开讨论。

## 示例工作流程

以下是我如何为实际功能使用 `/deep-planning` 的：

<Steps>
  <Step title="启动规划">
    我输入 `/deep-planning 为 API 响应实现缓存层`
  </Step>
  <Step title="静默调查">
    Cline 探索我的代码库，检查：
    - 当前 API 结构和端点
    - 现有数据流模式
    - 数据库查询和性能瓶颈
    - 配置和环境设置
  </Step>
  <Step title="有针对性讨论">
    Cline 问我：
    - "我们应该使用 Redis 还是内存缓存？"
    - "用户数据缓存失效的可接受时间是多少？"
    - "您需要缓存无效化 webhook 吗？"
  </Step>
  <Step title="计划创建">
    Cline 生成 `implementation_plan.md`，包含：
    - 缓存服务类规范
    - Redis 连接配置
    - 带有缓存逻辑的修改 API 端点
    - 缓存键生成策略
    - 不同数据类型的 TTL 配置
  </Step>
  <Step title="任务生成">
    Cline 创建一个新任务，包含：
    - 对实施计划的引用
    - 读取特定部分的命令
    - 每个实施步骤的可跟踪待办事项
    - 切换到行动模式进行执行的请求
  </Step>
</Steps>

## 与计划/行动模式的集成

深度规划旨在与[计划/行动模式](/features/plan-and-act)无缝配合：

- 在计划模式中使用 `/deep-planning` 进行调查和规划阶段
- 生成的任务请求切换到行动模式进行实施
- 焦点链自动通过实施步骤跟踪进度

这种分离确保规划保持专注于架构，而实施保持专注于执行。

## 最佳实践

### 何时使用深度规划

在以下情况下使用 `/deep-planning`：
- 涉及代码库多个部分的功能
- 需要仔细协调的架构更改
- 与外部服务的复杂集成
- 需要系统性执行的重构工作
- 您通常会花时间在白板上讨论的任何功能

### 充分利用调查

让 Cline 彻底完成他的调查。计划的质量直接与他对您代码库的理解程度相关。如果您有他应该检查的特定区域，请在您的初始请求中提及。

### 审查计划

在开始实施之前始终审查 `implementation_plan.md`。计划是综合的但不是不可变的 - 如需要，您可以直接编辑它。将其视为您和 Cline 之间的协作文档。

### 跟踪进度

启用焦点链后，您的实施进度将在任务标头中显示。当 Cline 执行计划时，每个完成的步骤都会自动被勾选，为您提供复杂实施的实时可见性。

## 灵感

每当我即将构建通常需要设计文档的东西时，我都会使用 `/deep-planning`。我工作流程中的最近示例：

- **迁移身份验证系统**：深度规划映射了每个端点，识别了所有身份验证接触点，并创建了避免破坏性更改的迁移计划。

- **添加实时功能**：计划涵盖了 WebSocket 集成、事件处理、状态同步以及断开连接的回退机制。

- **数据库模式重构**：Cline 识别了所有受影响的查询，创建了迁移脚本，并计划了发布以最小化停机时间。

- **API 版本化实现**：计划详细说明了路由更改、向后兼容性层、弃用通知和客户端迁移路径。

`/deep-planning` 的力量在于它在实施之前强制进行深思熟虑的架构。这就像有一个高级开发者在您编写代码之前审查您的方法，只是这个开发者对您的整个代码库有完美的知识。

<Note>
  深度规划需要具有强推理能力的模型。它在最新一代模型（如 GPT-5、Claude 4、Gemini 2.5 或 Grok 4）上效果最佳。较小的模型可能在所需的全面分析上存在困难。
</Note>

对于不需要广泛规划的简单任务，考虑使用 [/newtask](/features/slash-commands/new-task) 创建带有上下文的重点任务，或者如果前进的道路很清楚，就直接跳入实施。
